<head>
<title>PyReg Demo</title>

<script type="text/javascript" src="web-socket-js/swfobject.js"></script>
<script type="text/javascript" src="web-socket-js/FABridge.js"></script>
<script type="text/javascript" src="web-socket-js/web_socket.js"></script>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="jquery.query.js"></script>
<script type="text/javascript" src="json2.min.js"></script>
<script type="text/javascript" src="pyreg.js"></script>

<script>
WebSocket.__swfLocation = "web-socket-js/WebSocketMain.swf"
// Create a python bridge
python = Python(21000)	
</script>

</head>

<style type="text/css">
</style>

	
<h1>PyReg Demo</h1>
<p>This project makes a simple bridge between your python and your javascript. You can use the browser as an interface and debug display for your code!
	
<p>Make sure this folder (pyreg) is in your path. Get things started by running:
<code>python -m ajax_run test.py</code>. This opens up a server, executes 'test.py', and drops you into an IPython shell.

<script>
</script>
<p>Ready: <span>[loading indicator]</span>

<h2>1. Javascript to Python</h2>

<script>
function evalpy() {
	python.eval($('#evaltxt').val(), function (data) {
		$('#evaloutput').html(JSON.stringify(data))
	})
}
function execpy() {
	python.exec($('#exectxt').val(), function (data) {
	})
}	
</script>

<p>Try evaluating python expressions and executing python statements. The statements are sent as strings, and the results are jsonified.
	
<br><input id="exectxt" value="A = {'a':'hello', 1:12}">
<input type="button" value="Execute" onClick="execpy()">
<br><input id="evaltxt" value="A['a']">
<input type="button" value="Evaluate" onClick="evalpy()">
Result: <code id="evaloutput"></code>

	
<h2>2. Python to Javascript</h2>
Go to your terminal, but keep the browser visible. Run a few of the following:

<div><code>pyreg.eval("alert('python says hi')")</code></div>
<div><code>pyreg.eval("loadimage()")</code></div>

<div><img width="250" id="image"/></div>

<script>
$(function() {
	/*
	python.eval('1', function(data) {
			alert(data)
	})
	python.eval('1', function(data) {
			alert(data)
	})*/
	//python.longpoll(1000)
})
</script>

<h1>ToDo</h1>
<pre>
- SimpleHTTPServer is annoying because it prints every request and I can't figure out how to make it quiet. Switching to Tornado or Twisted may help.
- Longpolling doesn't work right.
</pre>

